<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      layout:decorate="~{layouts/layout_basic}">

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>커뮤니티 상세 글 보기 - 드가자닷컴</title>
<link rel="stylesheet" th:href="@{/assets/css/style.css}">
<link rel="stylesheet" th:href="@{/assets/css/community-detail.css}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>

<body>
<main class="community-main" layout:fragment="content">
	<div class="community-container">

		<!-- 제목 -->
		<div class="post-title-section">
			<h1 th:text="${post.title}">제목</h1>
			<div class="post-meta">
				<span><i class="fas fa-user"></i> <strong th:text="${post.writer}">작성자</strong></span>
				<span>・</span>
				<span><i class="fas fa-tag"></i> <strong th:text="${post.category}">카테고리</strong></span>
				<span>・</span>
				<span><i class="fas fa-clock"></i> <strong th:text="${#dates.format(post.regdate, 'yyyy.MM.dd HH:mm')}">작성일</strong></span>
			</div>
		</div>

		<hr>

		<!-- 본문 -->
		<div class="post-content-section">
			<img th:src="@{'/upload/' + ${post.filename}}" alt="여행 사진">
			<div class="post-content" th:text="${post.content}">내용</div>
			<div class="post-stats">
				<span><i class="fas fa-eye"></i> <strong th:text="${post.viewCount}">0</strong> 조회</span>
				<span>・</span>
				<span><i class="fas fa-comment"></i> <strong th:text="${post.commentCount}">0</strong> 댓글</span>
				<span>・</span>
				<span><i class="fas fa-heart"></i> <strong th:text="${post.likeCount}">0</strong> 좋아요</span>
			</div>
		</div>

		<hr>

		<!-- 댓글 목록 -->
		<div class="post-comments-section">
			<h3>댓글 <span th:text="${#lists.size(replyList)}">0</span></h3>

			<div th:if="${#lists.isEmpty(replyList)}">
				<p>등록된 댓글이 없습니다.</p>
			</div>

			<div th:each="reply : ${replyList}" class="comment-item">
				<div class="comment-meta">
					<strong th:text="${post.writer}">작성자</strong>
					<span>・</span>
					<span th:text="${#dates.format(reply.regdate, 'yyyy.MM.dd HH:mm')}">작성일</span>
				</div>
				<div class="comment-content" th:text="${reply.content}">댓글 내용</div>
			</div>
		</div>

		<hr>

		<!-- 댓글 작성 -->
		<div class="post-reply-section">
			<h3>댓글 달기</h3>

			<div sec:authorize="isAuthenticated()">
				<form method="post" action="/community/reply">
					<input type="hidden" name="postId" th:value="${post.id}">
					<textarea name="content" rows="4" placeholder="댓글을 입력하세요" style="width: 100%;"></textarea>
					<button type="submit" class="reply-btn" style="margin-top: 10px;">댓글 작성</button>
				</form>
			</div>

			<div sec:authorize="isAnonymous()">
				<p>
					댓글을 작성하려면 <a href="/login">로그인</a>이 필요합니다.
				</p>
			</div>
		</div>

	</div>
</main>
</body>
</html>
